---
title: "HTTP/1.1"
publishedAt: "2024-06-19"
updatedAt: "2024-06-19"
wip: false
summary: ""
---

# HTTP

HTTP: 웹 브라우저와 웹 서버가 통신하는 규약

## 4가지 기본 요소

- 메서드와 경로
- 헤더
- 바디
- 스테이터스 코드

### 메서드와 경로

```sh
> GET /index.html HTTP/1.1
```

메서드

```sh
GET # 서버에 헤더와 콘텐츠 요청
POST # 서버에 새 리소스 생성
PUT # 서버의 리소스를 수정
DELETE # 서버의 리소스를 삭제
HEAD # 서버에 헤더만 요청
OPTIONS # 서버에 메서드 옵션 요청

$ curl -X POST http://localhost:3000
```

### 헤더

- `파일명:값`의 형식으로 본문 앞에 위치
- 서버와 클라이언트 사이에 필요한 추가 정보 등

```sh
> Host: google.com
> User-Agent: curl/8.1.2
> Referer: https://www.google.com # 클라이언트가 요청을 보낼때 보고 있던 페이지의 URL
> Authorization: Basic YWxhZGRib29rOjEyMzQ1Njc4OTA= # 인증 정보
> Content-Type: application/json # MIME Type
> Content-Length: 125 # 바디의 길이
> Content-Encoding: gzip # 압축 형식

$ curl -H "X-test: Hello" http://localhost:3000
```

- `X-`로 시작되는 헤더는 각 애플리케이션이 자유롭게 사용해도 됨.
- User-Agent는 curl에서 --user-agent(`-A`)를 사용해 변경 가능

```sh
$ curl -H -A "Mozilla/5.0" http://localhost:3000

> GET / HTTP/1.0
> Host: localhost:3005
> User-Agent: Mozilla/5.0
```

### 바디

### 스테이터스 코드

```sh
100 # 처리가 계속됨
200 # 성공
301 # 서버에서 클라이언트로의 명령. 오류가 아니라 정상 처리의 범주. 리다이렉트나 캐시 이용 지시
400 # 클라이언트가 보낸 요청에 오류가 있음
500 # 서버 오류
```

#### 리다이렉트 `300`

300번대 스테이터스의 일부는 서버가 브라우저에 대해 리다이렉트하도록 지시하는 스테이터스 코드이다. 300 이외의 경우는 Location 헤더를 사용해 리다이렉트할 곳을 서버에서 클라이언트로 전달한다.

**301 Moved Permanently**

- 메서드 변경: O
- 영구적
- 캐싱: O
- 설명: 도메인 전송, 웹사이트 이전, HTTPS

**302 Found**

- 메서드 변경: O
- 일시적
- 캐싱: 지시에 따름
- 설명: 일시적 관리, 모바일 기반 전송

**303 See Other**

- 메서드 변경: 허가
- 영구적
- 캐싱: 하지 않음
- 설명: 로그인 후 페이지 전환

**307 Temporary Redirect**

- 일시적
- 캐시: 지시에 따름

**308 Moved Permanently**

- 영구적
- 캐싱: O

영구적인지 일시적인지는 이동하는 이전 페이지가 이후에도 존재하는지로 분류한다. 새 도메인을 얻어 서버의 콘텐츠를 이동한 경우나 HTTP로 운영되던 페이지를 HTTPS로 전환한 경우에는 예전 페이지를 볼 일이 없다. 이때는 영구적인 리다이렉트가 된다. 점검 기간에만 요청을 관리 화면으로 리다이렉트할 경우는 점검이 끝나면 복구해 다시 활성화할 것이므로 일시적인 리다이렉트를 사용한다.

메서드 변경 여부는 첫 번째 요청이 POST이고, 두 번째 이후에 GET이나 HEAD를 사용할 경우에 사용자에게 확인할 필요 없이 실시할 수 있는지이다. 현재는 주로 다음과 같이 구분한다.

- 301/308: 요청된 페이지가 다른 장소로 이동했을 때 사용한다. 영구적으로 이동한다. 검색 엔진도 이 응답을 받으면 기존 페이지의 평가를 새로운 페이지로 계승한다. 구글은 검색 엔진에 페이지 이동을 전하는 수단으로서 301을 사용할 것을 권장한다.
- 302/307: 일시적인 이동이다. 모바일 전용 사이트로 이동하거나 관리 페이지를 표시한다.
- 303: 요청된 페이지에 반환할 콘텐츠가 없거나 혹은 원래 반환할 페이지가 따로 있을 때, 그쪽으로 이동시키려고 사용한다. 예를 들면, 로그인 페이지를 사용해 로그인한 후 원래 페이지로 이동하는 경우에 사용한다.

클라이언트는 Location 헤더 값을 보고, 다시 요청한다. 재전송할 때는 헤더 등도 다시 보낸다.

curl 커맨드에 `-L`을 부여하면, 응답이 300번대고 게다가 응답 헤더에 Location 헤더가 있으면 그 헤더에서 지정된 URL에 다시 요청을 보낸다. 리다이렉트 횟수도 `--max-redirs` 옵션으로 지정할 수 있다.

```sh
$ curl -L http://localhost:3000
```
